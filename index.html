<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Khoj Plus</title>
    <link rel="shortcut icon" href="khoj.png">
     <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    
    <div class="modal show" id="langModal" tabindex="-1" style="display: block;background-color: rgba(240, 248, 255, 0);">
        <div class="modal-dialog modal-dialog-centered" >
            <div class="modal-content" style="height: 50vh; text-align: center;justify-content:space-around;">
                <h1>Please select Your Language</h1>
                <select id="langSelect" class="form-select mt-3 mb-3" style="height: 10vh;font-size: 1.3rem;">
                    <option value="unselected" selected>Choose an option</option>
                    <option value="hindi">рд╣рд┐рдВрджреА</option>
                    <option value="punjabi">рикрй░риЬри╛римрйА</option>
                </select>
                <button class="btn mt-3"style="font-size:1.5rem;color:rgb(247, 212, 72);background:rgb(31, 40, 71);" onclick="selectLanguage()">Continue</button>
            </div>
        </div>
    </div>
<nav class="navbar d-none glass-navbar position-relative" id="nav">
    <div class="container-fluid">
      <span class="navbar-brand mx-auto centered-brand">Khoj+</span>
    </div>
  </nav>

<div class="container d-none" id="mainApp">
    <h2 class="text-center" id="appTitle">рдХреЛрдб рдЕрднреНрдпрд╛рд╕ - Python, Java, C#</h2>
    <p class=" text-center" id="appDesc">рдпрд╣ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдЖрдкрд╕реЗ рдкрдВрдЬрд╛рдмреА рдореЗрдВ рдХреЛрдбрд┐рдВрдЧ рд╕реЗ рдЬреБрдбрд╝реЗ рд╕рд╡рд╛рд▓ рдкреВрдЫреЗрдЧрд╛ред рдпрд╣ рдЖрдкрдХреЗ рдЬрд╡рд╛рдм рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдЧрд╛ рдФрд░ рдЖрдкрдХреЛ рдлреАрдбрдмреИрдХ рджреЗрдЧрд╛</p>
    <div class="mb-3">
    <button class="cool-button" id="getq" onclick="getQuestion()"><span>ЁЯО▓ рдирдпрд╛ рд╕рд╡рд╛рд▓ рд▓реЗрдВ</span></button>
  </div>

   <div id="questionSpinner" class="text-center d-none mb-3">
    <div class="spinner-border" role="status"></div>
    <p class="mt-2" id="qbr">рд╕рд╡рд╛рд▓ рд▓рд╛рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ...</p>
  </div>

  <div id="questionBox" class="d-none" style="padding-inline: 5vw;margin-block: 5vh;"></div>

  <div class="mb-3">
    <label for="languageCode" id="fla" class="form-label">ЁЯСитАНЁЯТ╗ рдХреЛрдбрд┐рдВрдЧ рднрд╛рд╖рд╛</label>
    <select id="languageCode" class="form-select" style="height: 10vh;font-size: 1.3rem;color: white;border: 2px solid rgb(247, 212, 72);background-color: rgb(21,32,55);">
      <option>Python</option>
      <option>Java</option>
      <option>C#</option>
    </select>
  </div>
   <div class="mb-3">
    <label for="codeArea" id="cda" class="form-label">ЁЯСЗ рдХреЛрдб рд▓рд┐рдЦреЗрдВ</label>
    <textarea id="codeArea" class="form-control" rows="8" style="background-color: rgb(21,32,55);color: green;"></textarea>
  </div>

  <div class="mb-3">
    <button class="cool-button" onclick="evaluateCode()" id="evalc"><span>ЁЯзк рдЬрд╛рдВрдЪреЗрдВ</span></button>
  </div>

  <div id="evalSpinner" class="text-center d-none mb-3">
    <div class="spinner-border" role="status"></div>
    <p class="mt-2" id="evalsp">AI рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░ рд░рд╣рд╛ рд╣реИ...</p>
  </div>

  <div id="resultBox" class="d-none"></div>
</div>

</body>
<script>
    let k = "";
    let model="deepseek/deepseek-chat-v3-0324:free"
    let selectedLang=null;

  async function loadk() {
  try {
    const res = await fetch("file.txt");
    if (res.ok) {
      k = ((await res.text()).trim());
      
    } else {
      console.error("тЭМ Failed to load API key file.");
    }
  } catch (err) {
    console.error("тЪая╕П Error loading API key:", err);
  }
}

// Call this function once at page load
loadk();

    function selectLanguage(){
        const lang=document.getElementById("langSelect").value;
        if(lang==="hindi"||lang==="punjabi"){
            selectedLang=lang;
            document.getElementById("langModal").style.display = "none";
            document.getElementById("mainApp").classList.remove("d-none");
            document.getElementById("nav").classList.remove("d-none");
        
        if (lang === "punjabi") {
        document.getElementById("appTitle").innerText = "риХрйЛриб риЕринри┐риЖри╕ - Python, Java, C#";
        document.getElementById("qbr").innerText="риЗрй▒риХ риири╡ри╛риВ ри╕ри╡ри╛ри▓ рикрйНри░ри╛рикрид риХрйАридри╛ риЬри╛ ри░ри┐ри╣ри╛ ри╣рйИ"
        document.getElementById("getq").innerText="риЗрй▒риХ риири╡ри╛риВ ри╕ри╡ри╛ри▓ рикрйНри░ри╛рикрид риХри░рйЛ";
        document.getElementsByClassName("fla").innerText="риХрйЛрибри┐рй░риЧ ринри╛ри╕ри╝ри╛:";
        document.getElementById("cda").innerText="риХрйЛрибри┐рй░риЧ риЦрйЗридри░:";
        document.getElementById("evalc").innerText="риЪрйИрй▒риХ риХри░рйЛ";
        document.getElementById("evalsp").innerText="AI риорйБри▓ри╛риВриХриг риХри░ ри░ри┐ри╣ри╛ ри╣рйИ";
        document.getElementById("appDesc").innerText = "риЗри╣ рикрйНри░рйЛриЧри░ри╛рио ридрйБри╣ри╛риирйВрй░ рикрй░риЬри╛римрйА ри╡ри┐рй▒риЪ риХрйЛрибри┐рй░риЧ ри╕ри╡ри╛ри▓ рикрйБрй▒риЫрйЗриЧри╛ред риЗри╣ ридрйБри╣ри╛рибрйЗ риЬри╡ри╛рим рижрйА риЬри╛риВриЪ риХри░рйЗриЧри╛ риЕридрйЗ ридрйБри╣ри╛риирйВрй░ рилрйАрибримрйИриХ рижрйЗри╡рйЗриЧри╛ред";
        model="deepseek/deepseek-chat-v3-0324:free"
      }
        
    }
}
async function getQuestion() {
    document.getElementById("questionSpinner").classList.remove("d-none");
    document.getElementById("questionBox").classList.add("d-none");

    const prompt = selectedLang === "punjabi"
      ? "риХри┐ри░рикри╛ риХри░риХрйЗ риЗрй▒риХ рижри░риори┐риЖриири╛ рикрй▒ризри░ рижри╛ риХрйЛрибри┐рй░риЧ ри╕ри╡ри╛ри▓ ри╕ри┐ри░рилри╝ рикрй░риЬри╛римрйА ри╡ри┐рй▒риЪ рижри┐риУред ри╕ри╡ри╛ри▓ ри╕ри╛рилри╝ риЕридрйЗ ри╕ризри╛ри░рии ри╣рйЛригри╛ риЪри╛ри╣рйАрижри╛ ри╣рйИред риХрйЛриИ риЬри╡ри╛рим, ри╡ри┐ри╡ри░риг риЬри╛риВ риЦри╛ри╕ риЪри┐рй░риирйНри╣ риири╛ рижри┐риУред\n\nрилри╛ри░риорйИриЯ риЗри╣ ри╣рйЛригри╛ риЪри╛ри╣рйАрижри╛ ри╣рйИ:\nри╕ри╡ри╛ри▓:\n[риЗрй▒риерйЗ ри╕ри╡ри╛ри▓ ри▓ри┐риЦрйЛ]\n\nриЙрижри╛ри╣ри░рии:\nриЗриирикрйБрй▒риЯ: [риЗрй▒риерйЗ риЗриирикрйБрй▒риЯ]\nриЖриЙриЯрикрйБрй▒риЯ: [риЗрй▒риерйЗ риЖриЙриЯрикрйБрй▒риЯ]"
      : 'рдХреГрдкрдпрд╛ рдПрдХ рдордзреНрдпрдо рд╕реНрддрд░ рдХрд╛ рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рд╕рд╡рд╛рд▓ рдХреЗрд╡рд▓ рд╣рд┐рдВрджреА рдореЗрдВ рджреЗрдВред рд╕рд╡рд╛рд▓ рд╕реНрдкрд╖реНрдЯ рдФрд░ рд╕рдВрдХреНрд╖рд┐рдкреНрдд рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред рдХреЛрдИ рдЙрддреНрддрд░, рд╕реНрдкрд╖реНрдЯреАрдХрд░рдг рдпрд╛ рд╡рд┐рд╢реЗрд╖ рдЪрд┐рдиреНрд╣ рди рджреЗрдВред \n рдкреНрд░рд╛рд░реВрдк рдЗрд╕ рддрд░рд╣ рд╣реЛ: \n рд╕рд╡рд╛рд▓: \n [рдпрд╣рд╛рдБ рд╕рд╡рд╛рд▓ рд▓рд┐рдЦреЗрдВ] \n рдЙрджрд╛рд╣рд░рдг: \nрдЗрдирдкреБрдЯ: [рдпрд╣рд╛рдБ рдЗрдирдкреБрдЯ] \n рдЖрдЙрдЯрдкреБрдЯ: [рдпрд╣рд╛рдБ рдЖрдЙрдЯрдкреБрдЯ]';
    console.log(prompt)
    const payload = {
      model: model,
      messages: [{ role: "user", content: prompt }]
    };
        const res = await fetch("https://openrouter.ai/api/v1/chat/completions", {
      method: "POST",
      headers: {
        "Authorization": `Bearer ${k}`,
        "Content-Type": "application/json"
      },
      body: JSON.stringify(payload)
    });

    
      if (res.ok) {
      const json = await res.json();
      const question = json.choices[0].message.content.replace(/[\*_~`#>]/g, "").trim();
      document.getElementById("questionSpinner").classList.add("d-none");
      document.getElementById("questionBox").innerText = question;
      console.log(question)
      document.getElementById("questionBox").classList.remove("d-none");
    } else {
      alert("AI рд╕реЗ рд╕рд╡рд╛рд▓ рдкреНрд░рд╛рдкреНрдд рдирд╣реАрдВ рд╣реЛ рд╕рдХрд╛ред");
    }
}


  async function evaluateCode() {
    model="deepseek/deepseek-chat-v3-0324:free";
    document.getElementById("evalSpinner").classList.remove("d-none");
    document.getElementById("resultBox").classList.remove("d-none");

    const question = document.getElementById("questionBox").innerText;
    const codeLang = document.getElementById("languageCode").value;
    const code= document.getElementById("codeArea").value;

const prompt = 
`рдкреНрд░рд╢реНрди (${codeLang} рдореЗрдВ):\n${question}

рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдЙрддреНрддрд░:
${code}

рдХреГрдкрдпрд╛ рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рдмрд┐рдВрджреБрдУрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЗрд╕ рдЙрддреНрддрд░ рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░реЗрдВ:

1. рдХреНрдпрд╛ рдХреЛрдб рд▓реЙрдЬрд┐рдХ рд╕реЗ рд╕рд╡рд╛рд▓ рдХреЛ рд╕рд╣реА рддрд░реАрдХреЗ рд╕реЗ рд╣рд▓ рдХрд░рддрд╛ рд╣реИ?
2. рдХреНрдпрд╛ рдХреЛрдб рд╕рднреА рдХреЛрдиреЛрдВ (edge cases) рдХреЛ рд╕рд╣реА рд╕реЗ рд╕рдВрднрд╛рд▓рддрд╛ рд╣реИ (рдЬреИрд╕реЗ рдЦрд╛рд▓реА рдЗрдирдкреБрдЯ)?
3. рдХреНрдпрд╛ рд╕рд┐рдВрдЯреИрдХреНрд╕ рдпрд╛ рдЗрдВрдбреЗрдВрдЯреЗрд╢рди рдореЗрдВ рдХреЛрдИ рддреНрд░реБрдЯрд┐ рд╣реИ?
4. рдХреНрдпрд╛ рдХреЛрдб рдкрдврд╝рдиреЗ рдпреЛрдЧреНрдп рдФрд░ рд╕реБрд╡реНрдпрд╡рд╕реНрдерд┐рдд рд╣реИ?

рдХреГрдкрдпрд╛ **рд╕рд┐рд░реНрдл рдлреАрдбрдмреИрдХ рджреЗрдВ** рдФрд░ рдХреЛрдИ рд╕рд╣реА рдХреЛрдб рди рд▓рд┐рдЦреЗрдВред рдЬрд╡рд╛рдм рдХреЗрд╡рд▓ ${selectedLang} рднрд╛рд╖рд╛ рдореЗрдВ рджреЗрдВред рдХреГрдкрдпрд╛ *, **, > рдЬреИрд╕реЗ рдЪрд┐рд╣реНрдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рди рдХрд░реЗрдВред 

рдпрджрд┐ рдХреЛрдб Python рд╣реИ, рддреЛ рдЗрдВрдбреЗрдВрдЯреЗрд╢рди рдФрд░ error handling рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред  
рдпрджрд┐ рдХреЛрдб Java рдпрд╛ C# рд╣реИ, рддреЛ braces рдФрд░ structure рдХреА рд╕рд╛рд╡рдзрд╛рдиреАрдкреВрд░реНрд╡рдХ рд╕рдореАрдХреНрд╖рд╛ рдХрд░реЗрдВред`;

    const payload={
      model: model,
      messages:[{role:"user", content:prompt}]
    };
     const res = await fetch("https://openrouter.ai/api/v1/chat/completions", {
      method: "POST",
      headers: {
        "Authorization": `Bearer ${k}`,
        "Content-Type": "application/json"
      },
      body: JSON.stringify(payload)
    });

    const json = await res.json();
const answer = json.choices[0].message.content.replace(/[\*_~`#>]/g, "").trim();
document.getElementById("resultBox").innerText = answer;
document.getElementById("resultBox").classList.remove("d-none");

    if (res.ok) {
      document.getElementById("evalSpinner").classList.add("d-none");

      const answer = json.choices[0].message.content.replace(/[\*_~`#>]/g, "").trim();
      document.getElementById("resultBox").innerText = answer;
      document.getElementById("resultBox").classList.remove("d-none");
    } else {
      let error= selectedLang=="hindi"?"AI рд╕реЗ рдЙрддреНрддрд░ рдирд╣реАрдВ рдорд┐рд▓рд╛ред":"AI риХрйЛри▓ риХрйЛриИ риЬри╡ри╛рим риири╣рйАриВ ри╣рйИред";
      alert(error);
    }
  }
    
</script>
</html>